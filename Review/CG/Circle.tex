\section{圆}
处理圆的交并问题一般考虑圆之间的覆盖区间。
\subsection{圆的并}
求圆的并的面积。

首先去除被其他圆覆盖的圆。然后对于每个圆与其它圆求交点，得到每个圆被覆盖的弧度区间
（逆时针为正方向）。注意跨越弧度$\pi$的区间要分为两个区间。对每个圆的覆盖区间排序
得到不覆盖的区间。

画图可以发现圆并的面积等于圆弧面积+多边形的有向面积。由于多边形需要计算有向面积（直接
以原点作为基准点），不能直接计算扇形面积和。

对于半径为$R$的圆，弧度为$x$的圆弧的面积为$\frac{1}{2}(x-\sin x)R^2$。
当$x> \pi$时该等式也满足。

两圆求交时用圆心、交点弦中点、某一交点构造两个直角三角形，然后根据勾股定理列出方程组，
解出一个圆心到交点弦中点的距离，进而解出该三角形各边长，使用向量偏移计算交点弦中点和交点。

时间复杂度$O(n^2 \lg n)$。

代码如下：
\lstinputlisting{Source/Templates/CIRU.cpp}

\subsubsection{扩展}
求恰好被$i$个圆覆盖的区域面积。

同样对于每个圆考虑其覆盖区间，发现常规算法求出的被覆盖$i$次的区域对被覆盖$<i$次的区域
有贡献，因此计算完毕后要差分输出以扣除多余面积。
对覆盖分界点排序，每个区间差分标记覆盖，使用前缀和计算统计区间覆盖次数，
计算贡献。{\bfseries 注意覆盖次数要加上整个圆被覆盖的次数。}

\lstinputlisting{Source/Source/CG/CIRUT.cpp}

上述内容参考了Oyking的博客\footnote{
	SPOJ 8073 The area of the union of circles（计算几何の圆并）（CIRU）
	\url{https://www.cnblogs.com/oyking/p/3424999.html}
}。
\subsection{圆的交}
与求圆并同理，对于每个圆求出覆盖区间的交，答案贡献为圆弧面积+$\frac{1}{2}$区间交
两端点的叉积。
\subsection{最小圆覆盖}
\index{M!Minimum Covering Circle}
一般使用随机增量法：
\begin{enumerate}
	\item 将输入点随机重排列；
	\item 构造一个初始空圆（退化为点且没有点在这个点上）；
	\item 不断加入点更新当前最小覆盖圆，设当前点为$P_i$：
	\begin{enumerate}
		\item 若该点已经在该圆内，跳出；
		\item 否则该点必在新圆上。将当前圆重置为一个空圆，固定该圆必有点$P_i$。
		按顺序加入点$P_j,j<i$，若$P_j$不在当前圆内，则$P_j$也在新圆上。
		于是将当前圆重置为以$P_i,P_j$为直径的圆，找出不在当前圆上的点$P_k,k<j$，
		则$P_i,P_j,P_k$三点可确定一个圆，保证该圆是$P_i,P_j,P_x,x\leq k$的
		最小覆盖圆，更新当前圆后继续迭代。
	\end{enumerate}
\end{enumerate}

看似时间复杂度为$O(n^3)$，事实上该算法的时间复杂度为$O(n)$。

\paragraph{实现细节}
在求三角形外接圆时注意对三点共线的点取最远点对作为直径，三点不共线则使用中垂线求交
求外接圆。注意中垂线求交时要选用夹角较大的一对求交，并且对半径取max。

Update：其实不必考虑三点共线的情况，这种情况已经被之前的两点共线考虑过了，而求出来的
外接圆不会更优。

代码如下：
\lstinputlisting{Source/Templates/Cover.cpp}

上述内容参考了Wikipedia-EN\footnote{
	Smallest-circle problem - Wikipedia\\
	\url{https://en.wikipedia.org/wiki/Smallest-circle\_problem}
}。
\subsubsection{高维最小超球覆盖}
例题：LOJ\#6360. 复燃「恋之埋火」

可以沿用二维的情况进行随机增量法（DFS），关键在于如何根据给定的$k$个点生成$m$维超球，
且圆心在这$k$个点组成的$k-1$维平面上。

由于圆心在这$k$个点组成的$k-1$维平面上，可以使用$k-1$个向量组成线性基来表示圆心。
那么可以以$P_0$作为原点，$D_i=P_i-P_0$作为基向量。此时圆心被表示为这些基向量的线性
加权和，可以列出线性方程组。设圆心坐标为$O=P_0+Ax$，$A$是由基向量组成的矩阵，由于圆心
到这些点的距离相等，有$(Ax)^2=(Ax-D_i)^2$，展开化简得$2D_i^TAx=D_i^2$，高斯
消元解出$x$，再计算出$O$。

同理此题也不必考虑高斯消元无解的情况。
\subsection{圆的反演}
\paragraph{定义} 已知$\odot O$的半径为$r$，若点$P_1,P_2$在以点$O$为端点的射线上，
且$OP_1\cdot OP_2=r^2$，则称$P_1,P_2$关于$\odot O$互为反演，称点$O$为反演中心。

\begin{property}
	一条不经过反演中心的直线的反演图形是一个经过反演中心的圆。
\end{property}
可以根据直线到反演中心的距离与反演圆的半径的关系来互推。

\begin{property}
	一个不经过反演中心的圆的反演图形还是一个不经过反演中心的圆。
\end{property}
可以根据圆心与反演中心的直线上与两圆的四个交点（两两对应）解出反演图形的
半径和到反演中心的距离。

\subsubsection{求过定点且与两个圆相切的圆}
以定点为反演中心，计算两个圆的反演圆，求反演圆的公切线，再做一次反演就可以得到
经过反演中心的圆了。

以上内容参考了ACdreamer的博客\footnote{
	圆的反演变换 - ACdreamer\\
	\url{https://blog.csdn.net/acdreamers/article/details/16966369}
}。

BZOJ2961 共点圆:反演可以将过定点的圆周变成直线，而直线两边的半平面就对应了
圆内与圆外，因此在所有圆中的点集就是反演半平面的交。不过圆转直线的性质还可以
通过不等式化简计算，只不过此时维护的是凸包。
